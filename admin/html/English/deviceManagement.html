<!DOCTYPE html>
<!-- saved from url=(0093)http://www.17sucai.com/preview/1528155/2019-02-27/kj/admin-default/admin_left_menu/index.html -->
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="description" content="bootstrap default admin template">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>设备管理</title>


    <!-- Start global css -->
    <link rel="stylesheet" href="../../common/css/waves.min.css">
    <link rel="stylesheet" href="../../common/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../common/css/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../common/css/iconfont.css">

    <!-- End global css -->

    <!-- Start page plugin css -->
    <link rel="stylesheet" href="../../common/css/jqvmap.css">
    <!-- End page plugin css -->

    <!-- Start template global css -->
    <link href="../../common/css/components.min.css" type="text/css" rel="stylesheet">
    <!-- End template global css -->

    <!-- Start layout css -->
    <link rel="stylesheet" href="../../common/css/left_menu_layout.min.css">
    <link rel="stylesheet" href="../../common/css/bootstrap-editable.css">
    <link href="../../common/css/bootstrap-table.min.css" rel="stylesheet">


    <link rel="stylesheet" href="../../common/css/sidebar-menu.css">
    <link rel="stylesheet" href="../../common/css/bubble-slider.css">
    <link rel="stylesheet" href="../../common/css/easyui.css">
    <link rel="stylesheet" href="../../common/css/icon.css">

    <link rel="stylesheet" href="../../common/css/index.css">
    <link rel="stylesheet" href="../../common/css/English.css">
    <!-- End layout css -->

    <!-- Start favicon ico -->
    <link rel="icon" href="http://www.17sucai.com/preview/1528155/2019-02-27/kj/assets/favicon/prince.ico"
          type="image/x-icon">
    <link rel="icon" type="image/png" sizes="192x192"
          href="http://www.17sucai.com/preview/1528155/2019-02-27/kj/assets/favicon/prince-192x192.png">
    <link rel="apple-touch-icon" sizes="180x180"
          href="http://www.17sucai.com/preview/1528155/2019-02-27/kj/assets/favicon/prince-180x180.png">

</head>
<body class="nav-medium loadbar">
<div class="container body">
    <div class="main_container">
        <div class="col-md-3 left_color bg_bla">
            <div class="left_color scroll-view">
                <aside class="main-sidebar">
                    <section class="sidebar">
                        <ul class="sidebar-menu">
                            <li class="header logo"><img src="../../common/images/logo@2x.png" alt="logo"
                                                         class="img-responsive"></li>
                            <li class="notice"><i class="fa fa-volume-up"></i>Welcome to use XinZiDa Equipment Management System</li>
                            <li class="treeview">
                                <a href="index.html">
                                    <i class="iconfont icon-shouye1"></i><span>Home </span>
                                </a>
                            </li>
                            <li class="treeview">
                                <a href="camera.html" class="dropdown-toggle">
                                    <i class="iconfont icon-deng"></i>
                                    <span class="menu-text"> Lamp list </span>

                                    <i class="iconfont icon-jia pull-right change_icon"></i>
                                </a>
                                <ul class="treeview-menu">
                                    <li>
                                        <a href="lamp.html" class="dropdown-toggle">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            <span class="menu-text">  Lamp list</span>
                                        </a>


                                    </li>
                                </ul>
                            </li>
                            <li class="treeview">
                                <a href="camera.html" class="dropdown-toggle">
                                    <i class="iconfont icon-shiping-xue"></i>
                                    <span class="menu-text"> Camera management </span>

                                    <i class="iconfont icon-jia pull-right change_icon"></i>
                                </a>
                                <ul class="treeview-menu">
                                    <li>
                                        <a href="#" class="dropdown-toggle">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            <span class="menu-text">  Camera management</span>
                                        </a>


                                    </li>
                                </ul>
                            </li>

                            <li class="treeview">
                                <a href="#" class="dropdown-toggle">
                                    <i class="iconfont icon-deng1"></i>
                                    <span class="menu-text"> Lighting management </span>

                                    <i class="iconfont icon-jia pull-right change_icon"></i>
                                </a>

                                <ul class="treeview-menu">
                                    <li>
                                        <a href="light.html" class="dropdown-toggle">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            Lighting management
                                        </a>

                                    </li>

                                    <li>
                                        <a href="timeState.html">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            Real time state
                                        </a>
                                    </li>
                                    <li>
                                        <a href="control.html">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            centralized control
                                        </a>
                                    </li>
                                    <li>
                                        <a href="planIssued.html">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            Plan issued
                                        </a>
                                    </li>
                                    <li>
                                        <a href="deviceManagement.html">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            Device management
                                        </a>
                                    </li><li>
                                    <a href="timePlan.html">
                                        <i class="iconfont icon-xiangyou2"></i>
                                        Time plan
                                    </a>
                                </li>
                                    <li>
                                        <a href="outputMode.html">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            Brightness mode
                                        </a>
                                    </li>
                                    <li>
                                        <a href="singleLamp.html">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            Illumination map
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="treeview">
                                <a href="#" class="dropdown-toggle">
                                    <i class="iconfont icon-yiliaohangyedeICON-"></i>
                                    <span class="menu-text"> User management </span>

                                    <i class="iconfont icon-jia pull-right change_icon"></i>
                                </a>
                                <ul class="treeview-menu">
                                    <li>
                                        <a href="userlist.html" class="dropdown-toggle">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            <span class="menu-text">  User management</span>
                                        </a>


                                    </li>
                                    <li>
                                        <a href="role.html" class="dropdown-toggle">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            <span class="menu-text">  Role management</span>
                                        </a>


                                    </li>
                                </ul>
                            </li>
                            <li class="treeview">
                                <a href="#">
                                    <i class="iconfont icon-guanggao"></i>
                                    <span>Advertising management</span>
                                    <i class="iconfont icon-jia pull-right change_icon"></i>
                                </a>
                                <ul class="treeview-menu">
                                    <li>
                                        <a href="ad.html">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            Advertising management
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="treeview">
                                <a href="#" class="dropdown-toggle">
                                    <i class="iconfont icon-dianchibattery142"></i>
                                    Charging Pile Management
                                    <i class="iconfont icon-jia pull-right change_icon"></i>
                                </a>
                                <ul class="treeview-menu">
                                    <li>
                                        <a href="#">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            Charging Pile Management
                                        </a>
                                    </li>

                                </ul>
                            </li>
                            <li class="treeview">
                                <a href="#" class="dropdown-toggle">
                                    <i class="iconfont icon-wifi"></i>
                                    wifi  Management
                                    <i class="iconfont icon-jia pull-right change_icon"></i>
                                </a>
                                <ul class="treeview-menu">
                                    <li>
                                        <a href="#">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            wifi  Management
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="treeview">
                                <a href="#" class="dropdown-toggle">
                                    <i class="iconfont icon-baojingxiaoxi"></i>
                                    One touch alarm

                                    <i class="iconfont icon-jia pull-right change_icon"></i>
                                </a>
                                <ul class="treeview-menu">
                                    <li>
                                        <a href="#">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            One touch alarm
                                        </a>
                                    </li>


                                </ul>
                            </li>
                            <li class="treeview">
                                <a href="#" class="dropdown-toggle">
                                    <i class="iconfont icon-guzhangleixing"></i>
                                    Fault management
                                    <i class="iconfont icon-jia pull-right change_icon"></i>
                                </a>
                                <ul class="treeview-menu">
                                    <li>
                                        <a href="#" class="dropdown-toggle">
                                            <i class="iconfont icon-xiangyou2"></i>
                                            Fault management
                                            <!--<i class="iconfont icon-jia pull-right change_icon"></i>-->
                                        </a>
                                    </li>

                                </ul>
                            </li>
                            <li class="treeview">
                                <a href="map.html">
                                    <i class="iconfont icon-address"></i>
                                    <sapn>Display map</sapn>
                                </a>
                            </li>
                        </ul>
                    </section>
                </aside>
            </div>
        </div>
        <div class="top_nav">
            <div class="nav_menu nav_menu_content">
                <nav>
                    <div class="nav toggle">
                        <a id="menu_toggle"><i class="fa fa-bars"></i></a>
                    </div>
                    <div class="login_history">
                        <div class="hello_txt"><span class="user_name">xxx</span>, Welcome back!</div>
                        <div class="ip_adress">The IP address of the last login:<span class="ip_num">188.188.188.18</span></div>
                        <div class="login_time">Last logon time:<span class="time_txt">2018-12-26 </span></div>
                    </div>

                    <div class="topbar-right">
                        <div class="nav navbar-nav navbar-right">
                            <div class="home_link">
                                <a href="#"><i class="fa fa-home"></i>Home</a>
                            </div>
                            <div class="dropdown header-notification right-icon home_link">
                                <a href="javascript:" class="dropdown-toggle waves-effect waves-light notification-icon"
                                   data-toggle="dropdown" aria-expanded="false">
                                    <i class="fa fa-bell-o" aria-hidden="true"></i>

                                    <span class="label label-danger">5</span>
                                </a>
                                <span class="note">News</span>
                                <ul class="dropdown-menu">
                                    <li class="text-center">
                                        <p class="notification-title">Notification<span
                                                class="label label-primary">4</span></p>
                                    </li>
                                    <div class="slimScrollDiv"
                                         style="position: relative; overflow: hidden; width: auto; height: 250px;">
                                        <li class="list-group default-scroll"
                                            style="overflow: hidden; width: auto; height: 250px;">
                                            <a href="javascript:;" class="list-group-item">
                                                <div class="media">
                                                    <div class="pull-left">
                                                        <img src="../../common/images/user10.jpg" alt="user">
                                                    </div>
                                                    <div class="media-body">
                                                        <h5 class="media-heading"><span>Domance Den</span> posted a
                                                            photo on
                                                            your wall.</h5>
                                                    </div>
                                                </div>
                                            </a>
                                            <a href="javascript:;" class="list-group-item">
                                                <div class="media">
                                                    <div class="pull-left">
                                                        <img src="../../common/images/user10.jpg" alt="user">
                                                    </div>
                                                    <div class="media-body">
                                                        <h5 class="media-heading"><span>Wikko Menta</span> commented on
                                                            your
                                                            last video.</h5>
                                                    </div>
                                                </div>
                                            </a>
                                            <a href="javascript:;" class="list-group-item">
                                                <div class="media">
                                                    <div class="pull-left">
                                                        <img src="../../common/images/user10.jpg" alt="user">
                                                    </div>
                                                    <div class="media-body">
                                                        <h5 class="media-heading"><span>Jonny Sem</span> posted 4
                                                            comments
                                                            on your photo.</h5>
                                                    </div>
                                                </div>
                                            </a>
                                            <a href="javascript:;" class="list-group-item">
                                                <div class="media">
                                                    <div class="pull-left">
                                                        <img src="../../common/images/user10.jpg" alt="user">
                                                    </div>
                                                    <div class="media-body">
                                                        <h5 class="media-heading"><span>Doli Senga</span> posted a photo
                                                            on
                                                            your wall.</h5>
                                                    </div>
                                                </div>
                                            </a>
                                            <a href="javascript:;" class="list-group-item">
                                                <div class="media">
                                                    <div class="pull-left">
                                                        <img src="../../common/images/user10.jpg" alt="user">
                                                    </div>
                                                    <div class="media-body">
                                                        <h5 class="media-heading"><span>Bhura Kenta</span> commented on
                                                            your
                                                            last video.</h5>
                                                    </div>
                                                </div>
                                            </a>
                                            <a href="javascript:;" class="list-group-item">
                                                <div class="media">
                                                    <div class="pull-left">
                                                        <img src="../../common/images/user10.jpg" alt="user">
                                                    </div>
                                                    <div class="media-body">
                                                        <h5 class="media-heading"><span>Jolly Baby</span> posted 2
                                                            comments
                                                            on your photo.</h5>
                                                    </div>
                                                </div>
                                            </a>

                                        </li>
                                        <div class="slimScrollBar"
                                             style="background: rgb(170, 170, 170); width: 5px; position: absolute; top: 0px; opacity: 0; display: block; border-radius: 7px; z-index: 99; right: 1px;"></div>
                                        <div class="slimScrollRail"
                                             style="width: 5px; height: 100%; position: absolute; top: 0px; display: none; border-radius: 7px; background: rgb(51, 51, 51); opacity: 0.2; z-index: 90; right: 1px;"></div>
                                    </div>
                                    <li class="all-notification">
                                        <a href="javascript:;" class="list-group-item text-right">
                                            <small>See all notifications</small>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div class="home_link">
                                <a href="#"><img src="../../common/images/xitong@2x.png" alt="">System management</a>
                            </div>
                            <div class="home_link">
                                <a href="#"><i class="fa fa-reply"></i>Return</a>
                            </div>
                            <div class="dropdown user-profile right-icon anvant_border">
                                <a href="javascript:" class="dropdown-toggle waves-effect waves-light"
                                   data-toggle="dropdown" aria-expanded="false">
                                    <img src="../../common/images/user10.jpg" alt="user">
                                </a>
                                <ul class="dropdown-menu">
                                    <li><a href="javascript:" class="waves-effect waves-light">
                                        <i class="fa fa-user" aria-hidden="true"></i>Profile</a>
                                    </li>
                                    <li><a href="javascript:" class="waves-effect waves-light">
                                        <i class="fa fa-cog" aria-hidden="true"></i>Settings</a>
                                    </li>
                                    <li><a href="javascript:" class="waves-effect waves-light">
                                        <i class="fa fa-lock" aria-hidden="true"></i>Lock screen</a>
                                    </li>
                                    <li role="separator" class="divider"></li>
                                    <li><a href="javascript:" class="waves-effect waves-light">
                                        <i class="fa fa-power-off text-danger" aria-hidden="true"></i> Logout</a>
                                    </li>
                                </ul>
                            </div>

                        </div>

                    </div>
                </nav>
            </div>
        </div>
        <div class="page-main-header page_title">
            <!-- Page Title -->
            <h2 class="page-name-title"><i class="iconfont icon-deng1"></i><span>Lighting management</span></h2>
            <!--  Breadcrumb -->
            <ol class="breadcrumb breadcrumb_content"><span class="here_txt">Here you are:</span>
                <li>
                    <a href="timeState.html">device management</a>
                </li>

                <li class="text-info">Lighting management</li>

            </ol>
        </div>

        <div class="container-fluid right_color main_box user_page">
           <div class="side_content">
               <div class="lamp_list  time_state ">
                   <div class="group_list ">
                       <table id="group" class="bg_white">
                       </table>

                       <div id="toolbar" class="btn-group clearfix">
                           <p class="table_title left">
                               Device group：
                           </p>
                           <a href="#" class="add_lamp_btn control_btn add_group_btn add_group right" onclick="newGroup()">
                               Add group
                           </a>
                       </div>
                   </div>

                   <div id="dlg" class="easyui-dialog" style="width:400px" data-options="closed:true,modal:true,border:'thin',buttons:'.dlg-buttons'">
                       <form id="fm" method="post" novalidate style="margin:0;padding:20px 50px" >
                           <div style="margin-bottom:10px">
                               <input name="group_name" class="easyui-textbox" required="true" label="Group name:" style="width:100%">
                           </div>
                       </form>
                   </div>
                   <div id="dlg1" class="easyui-dialog" style="width:400px" data-options="closed:true,modal:true,border:'thin',buttons:'.dlg-buttons1'">
                       <form id="fm1" method="post" novalidate style="margin:0;padding:20px 50px" >
                           <div style="margin-bottom:10px">
                           <input name="id" class="easyui-textbox" required="true" label="device ID" style="width:100%">
                           </div>
                           <div style="margin-bottom:10px">
                           <input name="group_name" class="easyui-textbox" required="true"  label="device name:" style="width:100%">
                           </div>
                       </form>
                   </div>
                   <div  class="dlg-buttons">
                       <a href="javascript:void(0)" class="easyui-linkbutton c6" iconCls="icon-ok" onclick="saveUser()" style="width:90px">Save</a>
                       <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#dlg').dialog('close')" style="width:90px">Cancel</a>
                   </div>
                   <div  class="dlg-buttons1">
                       <a href="javascript:void(0)" class="easyui-linkbutton c6" iconCls="icon-ok" onclick="saveUser()" style="width:90px">Save</a>
                       <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#dlg1').dialog('close')" style="width:90px">Cancel</a>
                   </div>
                   <div id="dlg2" class="easyui-dialog" style="width:60%" data-options="closed:true,modal:true,border:'thin',buttons:'.dlg-buttons2'">
                       <form id="fm2" method="post" novalidate style="margin:0;padding:20px 50px" >
                           <table id="device_select_list"></table>

                       </form>
                   </div>
                   <div  class="dlg-buttons2">
                       <a href="javascript:void(0)" class="easyui-linkbutton c6" iconCls="icon-ok" onclick="saveUser()" style="width:90px">Save</a>
                       <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#dlg2').dialog('close')" style="width:90px">Cancel</a>
                   </div>




               </div>
           </div>




        </div>


    </div>
    <div id="back-to-top">
        <i class="iconfont icon-huidaodingbu"></i>
    </div>

</div>

</div>


<!--!&#45;&#45; Start core js &ndash;&gt;-->
<script src="../../common/js/jquery.min.js"></script>
<script src="../../common/js/jquery.easyui.min.js"></script>
<script src="../../common/js/easyui-lang-zh_CN.js"></script>
<script src="../../common/js/bootstrap.min.js"></script>
<script src="../../common/js/jquery.slimscroll.js"></script>
<script src="../../common/js/left-menu.min.js"></script>
<script src="../../common/js/sidebar-menu.js"></script>
<script src="../../common/js/jquery.bubble-slider.js"></script>
<script src="../../common/js/waterfall.js"></script>

<script>
    $.sidebarMenu($('.sidebar-menu'))

</script>
<script src="../../common/js/bootstrap-table.min.js"></script>
<!-- 引入中文语言包 -->
<script src="../../common/js/bootstrap-table-zh-CN.min.js"></script>

<script>

    $(function () {
        //1.初始化Table
        var oTable = new TableInit();
        oTable.Init();
        //2.初始化Button的点击事件
        var oButtonInit = new ButtonInit();
        oButtonInit.Init();
    });

    var TableInit = function () {
        var oTableInit = new Object();
        //初始化Table
        oTableInit.Init = function () {
            $('#group').bootstrapTable({
                url: 'data2.json',         //请求后台的URL（*）
                height:'550',
                method: 'get',                      //请求方式（*）
                toolbar: '#toolbar',                //工具按钮用哪个容器
                dataType: 'json',
                striped: true,                      //是否显示行间隔色
                cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
                pagination: true,                   //是否显示分页（*）
                sortable: false,                     //是否启用排序
                sortOrder: "asc",                   //排序方式
                queryParams: oTableInit.queryParams,//传递参数（*）
                // sidePagination: "server",           //分页方式：client客户端分页，server服务端分页（*）
                pageNumber: 1,                       //初始化加载第一页，默认第一页
                pageSize: 10,                       //每页的记录行数（*）
                pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
                search: true,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大
                contentType: "application/x-www-form-urlencoded",
                strictSearch: true,
                showColumns: false,                  //是否显示所有的列
                showRefresh: false,                  //是否显示刷新按钮
                minimumCountColumns: 2,             //最少允许的列数
                clickToSelect: true,                //是否启用点击选中行
                uniqueId: "id",                     //每一行的唯一标识，一般为主键列
                detailView: true,                   //是否显示父子表
                // dataClickToSelect:true,
                checkboxHeader: true,
                selectItemName: '',
                columns: [{
                    checkbox: true,
                    visible: true                  //是否显示复选框
                },
                    {
                        field: "",
                        title: 'Serial number',
                        align: 'center',
                        valign: 'middle',
                        formatter: function (value, row, index) {

                            return index+1;

                        }
                    },

                    {
                        field: 'group_name',
                        title: 'Group name',
                        align: 'center',
                        valign: 'middle',
                        editable: {
                            mode: 'inline'
                        }
                    },

                    {
                        field: 'quantity',
                        title: 'Lamp pole quantity',
                        align: 'center',
                        valign: 'middle',
                        editable: {
                            mode: 'inline'
                        },
                        // formatter: emailFormatter //自定义方法，添加操作按钮
                    },

                    {
                        field: 'remove',
                        title: 'Remove',
                        align: 'center',
                        valign: 'middle',
                        events: operateEvents3 = {
                            'click .remove':function (e, value, row, index) {
                                $.messager.confirm('Confirm','Are you sure you want to destroy this user?',function(r){
                                    if (r){
                                        $.post('destroy_user.php',{id:row.id},function(result){
                                            if (result.success){
                                                // $('#dg').datagrid('reload');    // reload the user data
                                            } else {
                                                $.messager.show({    // show error message
                                                    title: 'Error',
                                                    msg: result.errorMsg
                                                });
                                            }
                                        },'json');
                                    }
                                });
                                $('#group').bootstrapTable('remove', {
                                    field: 'id',
                                    values: [row.id]
                                });
                            }
                        },
                        formatter: function (value, row, index) {//赋予的参数
                            return [
                                '<a class="btn_t  active remove" href="#" >remove</a>',
                            ].join('');
                        }
                    },

                    {
                        field: 'operate',
                        title: 'Details',
                        align: 'center',
                        valign: 'middle',
                        events: operateEvents = {
                            'click .open_list':function (e, value, row, index) {

                                if( $(".open_list").eq(index).html() =='Pack up the list'){
                                    $("#group").bootstrapTable('collapseRow',index);

                                    $(".open_list").eq(index).html("Unroll list")
                                    toggle()
                                }else{
                                    $("#group").bootstrapTable('expandRow', index);

                                    $(".open_list").eq(index).html("Pack up the list")
                                    // toggle()
                                }
                        }

                        },
                            formatter:  function (value, row, index) {//赋予的参数
                                return [
                                    '<a class="btn_t  active open_list" href="#" >Unroll list</a>',
                                ].join('');
                            }
                        },
                ],
                 detailFormatter:function(index, row) {
                return '<div class="child_table"><table id="ddv-' + index + '"   data-toolbar="#toolbar'+index+'"></table><div id="toolbar'+index+'">  <p class="table_title left">\n' +
                    '                           Device list:\n' +
                    '                       </p>\n' +
                    '                       <a href="#" class="add_lamp_btn control_btn add_group_btn add_group right add_device" onclick="newDevice()">\n' +
                    '                          Add device \n' +
                    '                       </a></div></div>';

            },

                //注册加载子表的事件。注意下这里的三个参数！
                onExpandRow: function (index, row, $detail) {
                  InitSubTable(index, row, $detail);
                    $(".open_list").eq(index).html("Pack up the list");





                },
                onCollapseRow:function (index,row,$detail) {
                    $(".open_list").eq(index).html("Unroll list")


                }



            });

        };




        //得到查询的参数
        oTableInit.queryParams = function (params) {
            var temp = {   //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
                limit: params.limit,   //页面大小
                offset: params.offset,
                sort: params.sort,      //排序列名
                sortOrder: params.order //排位命令（desc，asc）
            };
            return temp;
        };
        return oTableInit;
    };
    InitSubTable = function (index, row, $detail) {
        var parentid = row.id;

        var cur_table = $detail.find('table');
        $(cur_table).bootstrapTable({
            url: 'data4.json',
            method: 'get',
            dataType: 'json',
                    //工具按钮用哪个容器
            queryParams: { strParentID: parentid },
            ajaxOptions: { strParentID: parentid },
            clickToSelect: true,
            detailView: false,//父子表
            uniqueId: "rid",
            pageSize: 10,
            pageList: [10, 25],

            columns: [{
                checkbox: true
            }, {
                field: '',
                title: 'Serial number',
                align: 'center',
                valign: 'middle',
                formatter: function (value, row, index) {

                    return index+1;

                }

            },

                {
                    field: 'group_name',
                    title: '设备名称',
                    align: 'center',
                    valign: 'middle',
                    editable: {
                        mode: 'inline'
                    }
                },

                {
                    field: 'id',
                    title: '设备ID',
                    align: 'center',
                    valign: 'middle',
                    editable: {
                        mode: 'inline'
                    },
                    // formatter: emailFormatter //自定义方法，添加操作按钮
                },

                {
                    field: 'remove',
                    title: '删除',
                    align: 'center',
                    valign: 'middle',
                    events: operateEvents3 = {
                        'click .remove':function (e, value, row, index) {
                            $.messager.confirm('Confirm','Are you sure you want to destroy this user?',function(r){
                                if (r){
                                    $.post('destroy_user.php',{id:row.id},function(result){
                                        if (result.success){
                                            // $('#dg').datagrid('reload');    // reload the user data
                                        } else {
                                            $.messager.show({    // show error message
                                                title: 'Error',
                                                msg: result.errorMsg
                                            });
                                        }
                                    },'json');
                                }
                            });
                          $(".table").bootstrapTable('remove', {
                                field: 'id',
                                values: [row.id]
                            });
                        }
                    },
                    formatter: function (value, row, index) {//赋予的参数
                        return [
                            '<a class="btn_t  active remove" href="#" >删除</a>',
                        ].join('');
                    }
                },

                {
                    field: 'operate',
                    title: '详情',
                    align: 'center',
                    valign: 'middle',
                    events: operateEvents = {
                        'click .edit_btn':function (e, value, row, index) {
                            $('#dlg1').dialog('open').dialog('center').dialog('setTitle','编辑设备');
                            console.log(row)

                            $('#fm1').form('load',row);
                            // url = 'update_user.php?id='+row.id;

                        }

                    },
                    formatter:  function (value, row, index) {//赋予的参数
                        return [
                            '<a class="btn_t  active edit_btn" href="#" >编辑</a>',
                        ].join('');
                    }
                } ],


            onEditableSave: function (field, row, oldValue, $el) {
                $.ajax({
                    type: "post",
                    url: "data4.json",
                    data: row,
                    dataType: 'JSON',
                    success: function (data, status) {
                        if (status == "success") {
                            alert('提交数据成功');
                        }
                    },
                    error: function () {
                        alert('编辑失败');
                    },
                    complete: function () {

                    }

                });
            }
        });
    };
    var ButtonInit = function () {
        var oInit = new Object();
        var postdata = {};

        oInit.Init = function () {
            //初始化页面上面的按钮事件
            //初始化子表格(无线循环)

        };

        return oInit;
    };

    window.operateEvents3 = {
        'click .remove':function (e, value, row, index) {

            $('#group').bootstrapTable('remove', {
                field: 'id',
                values: [row.id]
            });
        }
    }





    // 添加
    var url;
    function newGroup(){
        $('#dlg').dialog('open').dialog('center').dialog('setTitle','添加分组');
        $('#fm').form('clear');
        url = 'save_user.php';
    }
    function newDevice(){
        $('#dlg2').dialog('open').dialog('center').dialog('setTitle','添加设备');
        $('#fm2').form('clear');
        url = 'save_user.php';
        $("#device_select_list").bootstrapTable({
            url: "data1.json",
            method: 'get',
            queryParams: "queryParams",
            sidePagination: "true",
            clickEdit: true,
            // classes:'table-no-bordered',
            contentType: "application/x-www-form-urlencoded",
            uniqueId: "ID",
            search:true,
            searchAlign: 'left',
            pagination: true, // 是否分页
            pageNumber: 1,                       //初始化加载第一页，默认第一页
            pageSize: 10,                       //每页的记录行数（*）
            pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
            columns: [
                {
                    checkbox: true,
                    visible: true
                },
                {
                    field: '',
                    title: 'Serial number',
                    align: 'center',
                    formatter: function (value, row, index) {

                        return index + 1;

                    }

                },
                {
                    field: 'name',
                    title: 'Lamp post name',
                    align: 'center',
                    valign: "middle"

                },
                {
                    field: 'id',
                    title: 'ID',
                    align: 'center',
                    valign: 'middle',
                },
                {
                    field: 'addTime',
                    title: 'Add time',
                    align: 'center',
                    valign: 'middle',
                    // formatter: emailFormatter //自定义方法，添加操作按钮
                },
                {
                    field: 'address',
                    title: 'Address',
                    align: 'center',
                    valign: 'middle',
                },

            ],
        });


    }

    // 保存
    function saveUser(){
        $('#fm').form('submit',{
            url: url,
            onSubmit: function(){
                return $(this).form('validate');
            },
            success: function(result){
                var result = eval('('+result+')');
                if (result.errorMsg){
                    $.messager.show({
                        title: 'Error',
                        msg: result.errorMsg
                    });
                } else {
                    $('#dlg').dialog('close');        // close the dialog
                    $('#dg').datagrid('reload');    // reload the user data
                }
            }
        });
    }





</script>




</body>
</html>